"use client";

import { useQuery } from "@tanstack/react-query";
import type { CrossAgentSession } from "@/entities/session";
import { queryKeys } from "@/shared/lib/query-keys";

/** Mock cross-agent sessions spanning 4 different agents. */
const MOCK_SESSIONS: CrossAgentSession[] = [
	{
		id: "sess-001",
		agentId: "agent-001",
		agentName: "Research Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-19T01:00:00Z"),
		endedAt: undefined,
		tokenCount: 12450,
		compactionCount: 0,
		status: "active",
	},
	{
		id: "sess-002",
		agentId: "agent-002",
		agentName: "Code Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-18T22:30:00Z"),
		endedAt: new Date("2026-02-19T00:15:00Z"),
		tokenCount: 34200,
		compactionCount: 1,
		status: "ended",
	},
	{
		id: "sess-003",
		agentId: "agent-003",
		agentName: "Data Agent",
		agentAvatar: undefined,
		model: "claude-opus-4",
		startedAt: new Date("2026-02-18T20:00:00Z"),
		endedAt: new Date("2026-02-18T21:45:00Z"),
		tokenCount: 8730,
		compactionCount: 0,
		status: "ended",
	},
	{
		id: "sess-004",
		agentId: "agent-004",
		agentName: "Writer Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-18T18:00:00Z"),
		endedAt: new Date("2026-02-18T19:30:00Z"),
		tokenCount: 15600,
		compactionCount: 0,
		status: "ended",
	},
	{
		id: "sess-005",
		agentId: "agent-001",
		agentName: "Research Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-18T15:00:00Z"),
		endedAt: new Date("2026-02-18T16:30:00Z"),
		tokenCount: 22100,
		compactionCount: 1,
		status: "compacted",
	},
	{
		id: "sess-006",
		agentId: "agent-002",
		agentName: "Code Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-18T12:00:00Z"),
		endedAt: new Date("2026-02-18T14:00:00Z"),
		tokenCount: 45800,
		compactionCount: 2,
		status: "compacted",
	},
	{
		id: "sess-007",
		agentId: "agent-003",
		agentName: "Data Agent",
		agentAvatar: undefined,
		model: "claude-opus-4",
		startedAt: new Date("2026-02-18T10:00:00Z"),
		endedAt: new Date("2026-02-18T11:00:00Z"),
		tokenCount: 5400,
		compactionCount: 0,
		status: "ended",
	},
	{
		id: "sess-008",
		agentId: "agent-004",
		agentName: "Writer Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-18T08:00:00Z"),
		endedAt: new Date("2026-02-18T09:15:00Z"),
		tokenCount: 18900,
		compactionCount: 0,
		status: "ended",
	},
	{
		id: "sess-009",
		agentId: "agent-001",
		agentName: "Research Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-17T22:00:00Z"),
		endedAt: new Date("2026-02-18T00:30:00Z"),
		tokenCount: 31200,
		compactionCount: 1,
		status: "compacted",
	},
	{
		id: "sess-010",
		agentId: "agent-002",
		agentName: "Code Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-17T20:00:00Z"),
		endedAt: new Date("2026-02-17T21:30:00Z"),
		tokenCount: 27800,
		compactionCount: 0,
		status: "ended",
	},
	{
		id: "sess-011",
		agentId: "agent-003",
		agentName: "Data Agent",
		agentAvatar: undefined,
		model: "claude-opus-4",
		startedAt: new Date("2026-02-17T16:00:00Z"),
		endedAt: new Date("2026-02-17T17:45:00Z"),
		tokenCount: 11200,
		compactionCount: 0,
		status: "ended",
	},
	{
		id: "sess-012",
		agentId: "agent-001",
		agentName: "Research Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-17T14:00:00Z"),
		endedAt: new Date("2026-02-17T15:00:00Z"),
		tokenCount: 9800,
		compactionCount: 0,
		status: "ended",
	},
	{
		id: "sess-013",
		agentId: "agent-004",
		agentName: "Writer Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-17T10:00:00Z"),
		endedAt: new Date("2026-02-17T12:00:00Z"),
		tokenCount: 24500,
		compactionCount: 1,
		status: "compacted",
	},
	{
		id: "sess-014",
		agentId: "agent-002",
		agentName: "Code Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-17T08:00:00Z"),
		endedAt: new Date("2026-02-17T09:30:00Z"),
		tokenCount: 19300,
		compactionCount: 0,
		status: "ended",
	},
	{
		id: "sess-015",
		agentId: "agent-003",
		agentName: "Data Agent",
		agentAvatar: undefined,
		model: "claude-opus-4",
		startedAt: new Date("2026-02-16T22:00:00Z"),
		endedAt: new Date("2026-02-17T00:00:00Z"),
		tokenCount: 14700,
		compactionCount: 0,
		status: "ended",
	},
	{
		id: "sess-016",
		agentId: "agent-001",
		agentName: "Research Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-16T18:00:00Z"),
		endedAt: new Date("2026-02-16T20:00:00Z"),
		tokenCount: 38600,
		compactionCount: 2,
		status: "compacted",
	},
	{
		id: "sess-017",
		agentId: "agent-004",
		agentName: "Writer Agent",
		agentAvatar: undefined,
		model: "claude-sonnet-4",
		startedAt: new Date("2026-02-16T14:00:00Z"),
		endedAt: new Date("2026-02-16T15:30:00Z"),
		tokenCount: 11900,
		compactionCount: 0,
		status: "ended",
	},
];

async function fetchSessions(): Promise<CrossAgentSession[]> {
	await new Promise((resolve) => setTimeout(resolve, 350));
	return MOCK_SESSIONS;
}

/**
 * Fetches all sessions across agents with mock data.
 * staleTime: Infinity prevents refetch conflicts with real-time updates.
 */
export function useSessions() {
	return useQuery({
		queryKey: queryKeys.sessions.list(),
		queryFn: fetchSessions,
		staleTime: Number.POSITIVE_INFINITY,
		refetchOnWindowFocus: false,
	});
}
