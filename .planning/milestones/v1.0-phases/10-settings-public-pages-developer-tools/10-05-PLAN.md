---
phase: 10-settings-public-pages-developer-tools
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - src/features/docs/components/docs-sidebar.tsx
  - src/features/docs/components/doc-renderer.tsx
  - src/features/docs/lib/docs-content.ts
  - src/views/docs/docs-view.tsx
  - src/views/docs/doc-page-view.tsx
  - app/(dashboard)/docs/layout.tsx
  - app/(dashboard)/docs/page.tsx
  - app/(dashboard)/docs/[...slug]/page.tsx
  - src/features/developer-tools/components/scalar-api-reference.tsx
  - src/shared/config/openapi-spec.json
  - app/api/openapi.json/route.ts
  - src/views/developer-tools/api-docs-view.tsx
  - app/(dashboard)/api-docs/page.tsx
autonomous: true
requirements:
  - ADEV-01

must_haves:
  truths:
    - "User can browse internal documentation at /docs with a sidebar navigation tree"
    - "User can read individual doc pages at /docs/[...slug] rendered from markdown content"
    - "User can view interactive API documentation at /api-docs powered by Scalar"
    - "Scalar API reference syncs with the current theme (dark/light mode)"
  artifacts:
    - path: "src/features/docs/components/docs-sidebar.tsx"
      provides: "Docs sidebar with tree navigation matching internal categories"
      min_lines: 50
    - path: "src/features/docs/lib/docs-content.ts"
      provides: "Static doc content registry with titles, slugs, and markdown bodies"
      min_lines: 60
    - path: "src/features/developer-tools/components/scalar-api-reference.tsx"
      provides: "Scalar API reference React component with dark mode sync"
      min_lines: 20
    - path: "src/shared/config/openapi-spec.json"
      provides: "OpenAPI 3.1 spec documenting AXion Hub REST API endpoints"
      min_lines: 100
  key_links:
    - from: "app/(dashboard)/docs/[...slug]/page.tsx"
      to: "src/features/docs/lib/docs-content.ts"
      via: "getDocBySlug for content loading"
      pattern: "getDocBySlug"
    - from: "src/features/developer-tools/components/scalar-api-reference.tsx"
      to: "app/api/openapi.json/route.ts"
      via: "Scalar fetches spec from /api/openapi.json endpoint"
      pattern: "/api/openapi\\.json"
---

<objective>
Build the internal documentation hub and interactive Scalar API reference.

Purpose: Developers and users need searchable documentation inside the authenticated app shell, and an interactive API reference for exploring AXion Hub's REST API. Scalar provides the modern interactive API explorer.

Output: /docs with sidebar + markdown pages, /api-docs with embedded Scalar API reference viewer.
</objective>

<execution_context>
@/home/arya/.claude/get-shit-done/workflows/execute-plan.md
@/home/arya/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-settings-public-pages-developer-tools/10-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Internal documentation hub with sidebar navigation and markdown pages</name>
  <files>
    src/features/docs/components/docs-sidebar.tsx
    src/features/docs/components/doc-renderer.tsx
    src/features/docs/lib/docs-content.ts
    src/views/docs/docs-view.tsx
    src/views/docs/doc-page-view.tsx
    app/(dashboard)/docs/layout.tsx
    app/(dashboard)/docs/page.tsx
    app/(dashboard)/docs/[...slug]/page.tsx
  </files>
  <action>
    1. **Create docs content registry** (`src/features/docs/lib/docs-content.ts`):
       - Define `DocPage` type: { slug: string, title: string, category: string, content: string, order: number }
       - Define `DocCategory` type: { id: string, label: string, order: number }
       - Create DOC_CATEGORIES array with 6 categories:
         - getting-started (order 0)
         - agents (order 1)
         - missions (order 2)
         - gateway (order 3)
         - api-reference (order 4)
         - administration (order 5)
       - Create DOC_PAGES array with ~12-15 pages of static markdown content:
         - getting-started/quick-start: "Quick Start Guide" — brief onboarding steps
         - getting-started/architecture: "Architecture Overview" — explain app shell, gateway connection, FSD structure
         - getting-started/configuration: "Configuration Reference" — env vars, openclaw.json, Docker
         - agents/creating-agents: "Creating Agents" — wizard, templates, manual config
         - agents/agent-configuration: "Agent Configuration" — identity files, skills, tools, sandbox
         - agents/skills-and-tools: "Skills & Tools" — skill library, ClawHub, tool permissions
         - missions/mission-boards: "Mission Boards" — Kanban, columns, drag-and-drop
         - missions/task-management: "Task Management" — creation, assignment, deliverables
         - gateway/connection-setup: "Connection Setup" — WebSocket URL, authentication, modes
         - gateway/event-reference: "Event Reference" — common event types and payloads
         - gateway/troubleshooting: "Troubleshooting" — connection issues, common errors
         - api-reference/rest-api: "REST API" — brief overview linking to /api-docs
         - api-reference/websocket-protocol: "WebSocket Protocol" — brief overview linking to /api-docs/ws
         - api-reference/authentication: "Authentication" — API keys, session tokens
         - administration/user-management: "User Management" — teams, roles, invitations
         - administration/security: "Security Settings" — 2FA, sessions, API keys
         - administration/backup: "Backup & Recovery" — export, restore
       - Each page has genuine helpful markdown content (15-30 lines each), not lorem ipsum
       - Helper functions: `getDocBySlug(slug: string[])`, `getDocsByCategory(category: string)`, `getAllDocs()`

    2. **DocsSidebar** (`src/features/docs/components/docs-sidebar.tsx`):
       - "use client" component
       - Renders DOC_CATEGORIES as collapsible sections (default expanded)
       - Each category shows its pages as Link items
       - Active page highlighted using usePathname (similar to SettingsSidebar pattern)
       - Width: w-full md:w-56 shrink-0
       - Simple nav element (not shadcn Sidebar)
       - Optional: SearchInput at top for filtering doc pages by title (client-side filter)

    3. **DocRenderer** (`src/features/docs/components/doc-renderer.tsx`):
       - "use client" component accepting `content: string` prop
       - Uses MDEditor in preview-only mode via next/dynamic with ssr:false (matching existing project pattern for markdown rendering)
       - Wraps in `prose prose-neutral dark:prose-invert` styled container
       - Shows page title as h1 above the rendered content

    4. **DocsView** (`src/views/docs/docs-view.tsx`):
       - Landing page for /docs
       - Shows welcome message, quick links to popular docs, and a "Browse Categories" grid

    5. **DocPageView** (`src/views/docs/doc-page-view.tsx`):
       - Accepts `slug: string[]` prop
       - Calls getDocBySlug(slug) to get content
       - Renders DocRenderer with the content
       - Shows "Previous" / "Next" navigation links at bottom
       - 404 handling: if doc not found, show EmptyState

    6. **Layout and route pages**:
       - `app/(dashboard)/docs/layout.tsx`: flex layout with DocsSidebar + content area (matching settings layout pattern). PageHeader with title "Documentation".
       - `app/(dashboard)/docs/page.tsx`: server component rendering DocsView
       - `app/(dashboard)/docs/[...slug]/page.tsx`: server component, extract slug from params, render DocPageView. generateMetadata from doc title.
  </action>
  <verify>
    - `ls app/(dashboard)/docs/page.tsx app/(dashboard)/docs/layout.tsx` exist
    - `ls "app/(dashboard)/docs/[...slug]/page.tsx"` exists
    - `grep -r "getDocBySlug" src/features/docs/lib/docs-content.ts` confirms content lookup
    - `wc -l src/features/docs/lib/docs-content.ts` should be >60 lines
  </verify>
  <done>Documentation hub at /docs shows sidebar with 6 categories and ~15 pages. Each doc page renders markdown content. Navigation between pages works. All within authenticated app shell.</done>
</task>

<task type="auto">
  <name>Task 2: Scalar API reference and OpenAPI spec endpoint</name>
  <files>
    src/features/developer-tools/components/scalar-api-reference.tsx
    src/shared/config/openapi-spec.json
    app/api/openapi.json/route.ts
    src/views/developer-tools/api-docs-view.tsx
    app/(dashboard)/api-docs/page.tsx
  </files>
  <action>
    1. **Install @scalar/api-reference-react**:
       - `bun add @scalar/api-reference-react`

    2. **Create OpenAPI spec** (`src/shared/config/openapi-spec.json`):
       - OpenAPI 3.1.0 spec documenting AXion Hub's REST API
       - Info: title "AXion Hub API", version "1.0.0", description
       - Servers: [{ url: "/api", description: "AXion Hub API" }]
       - Paths covering the main API surface:
         - /api/auth/[...all]: Authentication endpoints (login, register, logout, session)
         - /api/health: Health check endpoint
         - /api/agents: Agent CRUD operations (GET list, POST create)
         - /api/agents/{agentId}: Agent detail (GET, PATCH, DELETE)
         - /api/sessions: Session listing (GET)
         - /api/sessions/{sessionId}: Session detail (GET)
         - /api/tasks: Task CRUD (GET, POST)
         - /api/tasks/{taskId}: Task detail (GET, PATCH, DELETE)
         - /api/workflows: Workflow CRUD (GET, POST)
         - /api/workflows/{workflowId}: Workflow detail (GET, PATCH, DELETE)
         - /api/audit: Audit log (GET with pagination)
         - /api/settings: Settings (GET, PATCH)
       - Components/schemas: Agent, Session, Task, Workflow, AuditEntry, ApiError
       - Security schemes: bearerAuth (API key), cookieAuth (session cookie)
       - Each endpoint has summary, description, parameters, request body (where applicable), and response schemas
       - Realistic and thorough but not exhaustive — this is the initial spec

    3. **OpenAPI spec route** (`app/api/openapi.json/route.ts`):
       - GET handler that reads and returns the spec JSON
       - `import spec from "@/shared/config/openapi-spec.json"`
       - Return `NextResponse.json(spec)` with cache headers (Cache-Control: public, max-age=3600)

    4. **ScalarApiReference** (`src/features/developer-tools/components/scalar-api-reference.tsx`):
       - "use client" component
       - Dynamic import: `import { ApiReferenceReact } from "@scalar/api-reference-react"` with `import "@scalar/api-reference-react/style.css"`
       - Use `useTheme()` from next-themes for dark mode sync
       - Configuration per research:
         ```
         url: "/api/openapi.json"
         darkMode: resolvedTheme === "dark"
         layout: "modern"
         showSidebar: true
         searchHotKey: "" (disable to avoid conflict with app Cmd+K)
         customCss: font overrides matching OKLCH theme
         ```
       - Per research Pitfall 1: wrap in container to isolate Scalar CSS if needed
       - The component must be loaded via next/dynamic with ssr: false since Scalar accesses browser APIs

    5. **ApiDocsView** (`src/views/developer-tools/api-docs-view.tsx`):
       - "use client" component
       - Renders ScalarApiReference full-width within the dashboard content area
       - No PageHeader (Scalar has its own header)
       - Full height: `min-h-[calc(100vh-4rem)]` to fill viewport

    6. **API docs route page** (`app/(dashboard)/api-docs/page.tsx`):
       - Server component
       - generateMetadata: title "API Reference"
       - Renders ApiDocsView
  </action>
  <verify>
    - `ls app/(dashboard)/api-docs/page.tsx` exists
    - `ls src/shared/config/openapi-spec.json` exists
    - `grep -r "ApiReferenceReact\|@scalar" src/features/developer-tools/components/scalar-api-reference.tsx` confirms Scalar usage
    - `curl -s http://localhost:3000/api/openapi.json | head -5` returns JSON (if dev server running)
    - `wc -l src/shared/config/openapi-spec.json` should be >100 lines
  </verify>
  <done>Interactive API documentation at /api-docs renders Scalar viewer with full OpenAPI spec. Spec served from /api/openapi.json endpoint. Dark mode syncs with app theme. Scalar search hotkey disabled to avoid conflict with app Cmd+K.</done>
</task>

</tasks>

<verification>
1. /docs renders with sidebar showing 6 categories and ~15 doc pages
2. Clicking a doc page navigates to /docs/[category]/[page] and renders markdown content
3. /api-docs renders Scalar interactive API reference
4. /api/openapi.json returns the OpenAPI spec
5. Scalar dark mode syncs when toggling app theme
6. All pages accessible only when authenticated (inside app shell)
</verification>

<success_criteria>
- Docs sidebar shows categorized navigation with active state
- Doc pages render markdown content with previous/next navigation
- Scalar API reference loads and displays all documented endpoints
- OpenAPI spec covers auth, agents, sessions, tasks, workflows, audit, settings
- Dark/light theme switching works in both docs and Scalar
- No CSS conflicts between Scalar and app theme
</success_criteria>

<output>
After completion, create `.planning/phases/10-settings-public-pages-developer-tools/10-05-SUMMARY.md`
</output>
