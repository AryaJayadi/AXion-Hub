---
phase: 09-skills-plugins-workflows
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/entities/skill/model/types.ts
  - src/entities/skill/model/schemas.ts
  - src/entities/skill/index.ts
  - src/features/skills/api/use-skills.ts
  - src/features/skills/api/use-skill-detail.ts
  - src/features/skills/api/use-clawhub.ts
  - src/features/skills/components/skill-card.tsx
  - src/features/skills/components/skill-grid.tsx
  - src/features/skills/components/clawhub-browser.tsx
  - src/features/skills/components/skill-config-editor.tsx
  - src/features/skills/components/skill-agent-toggles.tsx
  - src/features/skills/model/skill-config-store.ts
  - src/views/skills/skills-library-view.tsx
  - src/views/skills/clawhub-view.tsx
  - src/views/skills/skill-detail-view.tsx
  - app/(dashboard)/skills/page.tsx
  - app/(dashboard)/skills/clawhub/page.tsx
  - app/(dashboard)/skills/[skillId]/page.tsx
  - src/shared/lib/query-keys.ts
autonomous: true
requirements:
  - SKIL-01
  - SKIL-02
  - SKIL-03

must_haves:
  truths:
    - "User can view installed skills in a card grid organized by category at /skills"
    - "User can browse ClawHub registry with featured/trending section, category tabs, and search at /skills/clawhub"
    - "User can view and configure a skill with JSON+form hybrid editor at /skills/[skillId]"
    - "User can enable/disable a skill per agent via toggle switches"
  artifacts:
    - path: "src/entities/skill/model/types.ts"
      provides: "Skill, SkillConfig, ClawHubSkill, SkillCategory types"
      min_lines: 40
    - path: "src/features/skills/components/skill-grid.tsx"
      provides: "Category-sectioned card grid for installed skills"
      min_lines: 30
    - path: "src/features/skills/components/clawhub-browser.tsx"
      provides: "Marketplace browser with featured section, category tabs, search"
      min_lines: 60
    - path: "src/features/skills/components/skill-config-editor.tsx"
      provides: "JSON+form hybrid config editor reusing Phase 7 pattern"
      min_lines: 60
    - path: "src/features/skills/model/skill-config-store.ts"
      provides: "Zustand draft store for skill config"
      min_lines: 40
  key_links:
    - from: "src/views/skills/skills-library-view.tsx"
      to: "src/features/skills/components/skill-grid.tsx"
      via: "imports and renders SkillGrid"
      pattern: "import.*SkillGrid"
    - from: "src/features/skills/components/skill-config-editor.tsx"
      to: "src/features/skills/model/skill-config-store.ts"
      via: "Zustand store for draft-then-apply config"
      pattern: "useSkillConfigStore"
    - from: "app/(dashboard)/skills/[skillId]/page.tsx"
      to: "src/views/skills/skill-detail-view.tsx"
      via: "route page renders view"
      pattern: "SkillDetailView"
---

<objective>
Build the complete skills library experience: installed skills grid at /skills, ClawHub marketplace browser at /skills/clawhub, and individual skill configuration page at /skills/[skillId] with JSON+form hybrid editor.

Purpose: Users need a central place to manage agent skills across their workspace and discover new skills from the ClawHub registry.
Output: 3 fully functional skill pages with entity types, mock data, Zustand config store, and TanStack Query hooks.
</objective>

<execution_context>
@/home/arya/.claude/get-shit-done/workflows/execute-plan.md
@/home/arya/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-skills-plugins-workflows/09-RESEARCH.md

Key patterns to follow:
- Phase 7 config editor: src/features/gateway/model/config-draft-store.ts (draft-then-apply Zustand store)
- Phase 7 config editor: src/features/gateway/components/config-editor.tsx (form/JSON toggle shell)
- Phase 3 agent skills: src/entities/agent/model/types.ts (AgentSkill type to extend)
- Phase 3 skill toggles: src/features/agents/components/agent-skills.tsx (optimistic mutation pattern)
- CodeMirror SSR-safe: src/features/workspace/components/code-editor.tsx (dynamic import pattern)
- Query keys: src/shared/lib/query-keys.ts (add skills and clawhub domains)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Skill entity types, query keys, and TanStack Query hooks with mock data</name>
  <files>
    src/entities/skill/model/types.ts
    src/entities/skill/model/schemas.ts
    src/entities/skill/index.ts
    src/features/skills/api/use-skills.ts
    src/features/skills/api/use-skill-detail.ts
    src/features/skills/api/use-clawhub.ts
    src/shared/lib/query-keys.ts
  </files>
  <action>
    Create the skill entity layer following FSD conventions:

    **types.ts**: Define types:
    - `SkillCategory`: union type of "code" | "communication" | "data" | "productivity" | "integration" | "security"
    - `SkillStatus`: "enabled" | "disabled" | "update_available"
    - `Skill`: id, name, description, category (SkillCategory), icon (string - lucide icon name), version, status (SkillStatus), agentCount (number of agents using it), configSchema (Record or null), installedAt (Date)
    - `ClawHubSkill`: id, name, description, category, icon, version, author, downloads, rating, featured (boolean), trending (boolean), installable (boolean), installed (boolean)
    - `SkillConfig`: Record<string, unknown> -- the config object for a skill
    - `SkillDetail`: extends Skill with config (SkillConfig | null), readme (string - markdown), agents (array of { id, name, enabled })

    **schemas.ts**: Zod v4 schemas (import from "zod/v4") for Skill and ClawHubSkill. Use z.object() with appropriate field types. Follow established pattern: z.string(), z.number(), z.boolean(), z.enum() for category/status.

    **index.ts**: Barrel export all types and schemas.

    **query-keys.ts**: Add `skills` and `clawhub` domains to the existing queryKeys object:
    ```
    skills: {
      all: ["skills"],
      lists: () => [...queryKeys.skills.all, "list"],
      list: (filters?) => [...queryKeys.skills.lists(), filters],
      details: () => [...queryKeys.skills.all, "detail"],
      detail: (id: string) => [...queryKeys.skills.details(), id],
    },
    clawhub: {
      all: ["clawhub"],
      lists: () => [...queryKeys.clawhub.all, "list"],
      list: (filters?) => [...queryKeys.clawhub.lists(), filters],
      categories: () => [...queryKeys.clawhub.all, "categories"],
    },
    ```

    **use-skills.ts**: TanStack Query hook returning mock installed skills data. 8-10 mock skills across all 6 categories. Use `useQuery` with `queryKeys.skills.lists()`, `staleTime: 30_000`. Include `useInstallSkill` and `useToggleSkill` mutations with optimistic updates.

    **use-skill-detail.ts**: `useSkillDetail(skillId)` hook returning a single SkillDetail with mock config, readme markdown, and agent list. `useUpdateSkillConfig` mutation.

    **use-clawhub.ts**: `useClawHubSkills(filters?)` returning 15-20 mock ClawHub skills with varied categories, some featured, some trending. Include `useInstallFromClawHub` mutation.
  </action>
  <verify>Run `npx tsc --noEmit` -- no type errors in the new files. Verify query-keys.ts still compiles with the new domains.</verify>
  <done>Skill entity types exported, query keys extended, and 3 TanStack Query hooks return realistic mock data for the skills library, skill detail, and ClawHub browser pages.</done>
</task>

<task type="auto">
  <name>Task 2: Skills library page, ClawHub browser, and skill detail/config page with views and routes</name>
  <files>
    src/features/skills/components/skill-card.tsx
    src/features/skills/components/skill-grid.tsx
    src/features/skills/components/clawhub-browser.tsx
    src/features/skills/components/skill-config-editor.tsx
    src/features/skills/components/skill-agent-toggles.tsx
    src/features/skills/model/skill-config-store.ts
    src/views/skills/skills-library-view.tsx
    src/views/skills/clawhub-view.tsx
    src/views/skills/skill-detail-view.tsx
    app/(dashboard)/skills/page.tsx
    app/(dashboard)/skills/clawhub/page.tsx
    app/(dashboard)/skills/[skillId]/page.tsx
  </files>
  <action>
    Build all three skill pages with their feature components:

    **skill-card.tsx**: Compact card component per user decision. Shows: dynamic lucide icon (use ICON_MAP Record<string, LucideIcon> pattern from Phase 3 templates), name, one-line description, StatusBadge for status (enabled/disabled/update_available). On click, navigates to /skills/[skillId]. Card uses `border bg-card rounded-lg p-4 hover:bg-muted/50 cursor-pointer transition-colors`.

    **skill-grid.tsx**: Groups skills by category, renders each category as a section with heading (category name + count) and grid of SkillCards. Uses `grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4`. Pass skills from parent. If no skills in category, skip that section.

    **clawhub-browser.tsx**: Marketplace-style page per user decision:
    - Top: SearchInput with nuqs URL state for search query
    - Below: Category tabs using shadcn Tabs component, one tab per category + "All" tab. Use nuqs for active category URL state.
    - Featured section: horizontal scroll row of featured skills (filter by featured=true), larger cards with author, downloads, rating
    - Trending section: row of trending skills
    - Main grid: all skills matching search/category filter, each with Install button. Install button triggers `useInstallFromClawHub` mutation, shows loading spinner during install.

    **skill-config-store.ts**: Zustand draft store following Phase 7 config-draft-store.ts pattern. State: originalConfig, draftConfig, isDirty, isRawJsonMode, validationErrors. Actions: loadConfig, updateField (dot-path), updateFromRawJson, toggleRawJsonMode, resetDraft. Use structuredClone for deep cloning.

    **skill-config-editor.tsx**: Reuses Phase 7 config editor pattern:
    - Toggle between form mode and raw JSON mode (use shadcn Switch or ToggleGroup)
    - Form mode: render FormField for each key in the skill's config schema. Use react-hook-form. Common types: string input, number input, boolean switch, select dropdown.
    - Raw JSON mode: CodeMirror editor (use dynamic import with ssr: false, same pattern as workspace code-editor.tsx). Language: json. Debounced sync to store.
    - Dirty indicator and Save/Reset buttons at bottom.
    - Read skill config store for state, write back via store actions.

    **skill-agent-toggles.tsx**: List of agents with Switch toggle for each. Shows agent name + avatar placeholder. Toggle calls a mutation to enable/disable this skill for that agent. Optimistic update pattern from Phase 3 skill toggles.

    **skill-detail-view.tsx**: Composition view for /skills/[skillId]:
    - PageHeader with skill name, back button to /skills, StatusBadge
    - Two-column layout on desktop (8/4 split): left = config editor, right = agent toggles
    - Below: readme section rendering the skill's readme markdown via @uiw/react-md-editor in preview mode (dynamic import, ssr: false)
    - Uses useSkillDetail(skillId) hook

    **skills-library-view.tsx**: PageHeader ("Skills Library") with action button linking to /skills/clawhub ("Browse ClawHub"). SearchInput with nuqs URL state for filtering. SkillGrid with useSkills() data filtered by search query. Loading skeleton while fetching.

    **clawhub-view.tsx**: PageHeader ("ClawHub Registry") with back link to /skills. Renders ClawHubBrowser component with useClawHubSkills() data.

    **Route pages**: Standard thin wrappers:
    - `app/(dashboard)/skills/page.tsx`: `export default function SkillsPage() { return <SkillsLibraryView /> }`
    - `app/(dashboard)/skills/clawhub/page.tsx`: renders ClawHubView
    - `app/(dashboard)/skills/[skillId]/page.tsx`: async server component, `await params`, passes `skillId` to SkillDetailView. Include `generateMetadata`.
  </action>
  <verify>Run `npx tsc --noEmit` -- no type errors. Navigate to /skills, /skills/clawhub, and /skills/[any-mock-id] in the browser -- all three pages render with mock data, category sections visible, config editor toggles between form and JSON modes.</verify>
  <done>Skills library shows installed skills in category-sectioned card grid, ClawHub shows marketplace browser with featured/trending/search/category filtering, and skill detail page shows JSON+form hybrid config editor with per-agent toggles.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. /skills renders card grid with 6 category sections and 8-10 mock skills
3. /skills/clawhub renders marketplace with featured section, category tabs, search bar, and install buttons
4. /skills/[skillId] renders config editor with form/JSON toggle, agent toggles, and readme section
5. Search filtering works on both /skills and /skills/clawhub
6. Status badges render correctly for enabled/disabled/update_available states
</verification>

<success_criteria>
User can browse installed skills at /skills, discover new skills at /skills/clawhub with search and category filtering, and configure individual skills at /skills/[skillId] with a JSON+form hybrid editor and per-agent enable/disable toggles.
</success_criteria>

<output>
After completion, create `.planning/phases/09-skills-plugins-workflows/09-01-SUMMARY.md`
</output>
